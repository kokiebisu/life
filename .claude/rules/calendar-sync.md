# Calendar Sync ルール

## 必須: スケジュール変更時は Notion Calendar も更新する

デイリープラン・週次プラン・ルーティンなどスケジュールに関わるマークダウンファイルを作成・変更したら、**必ず Notion Calendar も同期する。**

1. **新しいデイリープランを作成した場合** → プラン内のタスク・イベントを Notion に登録
2. **既存のスケジュールを変更した場合** → 変更内容を Notion に反映（追加・時間変更）
3. **イベントを別の日に移動した場合** → 移動先に新規登録

CLI コマンドは `/calendar` コマンドを参照。

### 1ブロック = 1タスク（厳守）

- 時間ブロックには**1つのタスクだけ**を入れる
- 「A + B」「A or B」「A / B / C」のような複合タイトルは禁止
- 複数やりたいことがあるなら、別々のブロックに分ける
- 夜の自由時間もその日に1つ選んで入れる（「study / 読書 / 投資」ではなく「読書」など）

### 重複防止（必須）

Notion にイベント・タスクを登録する**前に**、必ず以下の手順を踏む:

1. `notion-list.ts --date YYYY-MM-DD --json` でその日の既存エントリを取得
2. 同名または同内容のエントリが既にあるか確認
3. **既にある場合** → `notion-update-page` でプロパティを更新する（新規追加しない）
4. **ない場合のみ** → `notion-add.ts` で新規登録する

### 注意

- **スケジュール変更時は既存の Notion エントリを更新する**（Notion MCP `notion-update-page` で日時プロパティを変更）。二重登録しない
- マークダウンだけ更新して Notion を更新し忘れないこと

## ファイルの使い分け: events/ vs daily/

- **`planning/events/`** — 未来の予定。スケジュール管理用
- **`planning/daily/`** — その日の実績・記録用（完了タスク、持ち越し、Feedback 転記）

## Notion ページへのコンテンツ反映

コンテンツを持つタスク（ギターレッスン等）を Notion に登録するときは、**ページ本文にも内容を書き込む。**

- `notion-add.ts` でページ作成後、Notion MCP `notion-update-page` の `replace_content` で内容を書き込む
- 詳細な TAB 譜等はリポジトリファイルへの参照リンクを末尾に入れる

## Feedback の永続反映

Notion タスクに Feedback がある場合、**次回同種のタスク作成時に必ず反映する。**

1. タスク完了時に Feedback を確認
2. 該当 aspect の `CLAUDE.md` に学びとして蓄積
3. 次回同じタスクを立てるとき、過去の Feedback を踏まえた内容にする
