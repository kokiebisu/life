# Learn - ミスからの学習・再発防止

ユーザーが Claude のミスを指摘したときに使う。直前の失敗を振り返り、再発防止策を実行する。

## 引数

$ARGUMENTS — ミスの内容や補足（省略可。省略時は直前の会話から推測する）

## Step 1: 事実の確認

直前の会話を振り返り、以下を整理してユーザーに提示する:

```
### 何が起きたか
- [具体的な事象]

### なぜ起きたか（根本原因）
- [ルールの見落とし？ルール自体が未定義？手順のスキップ？判断ミス？]

### 影響
- [実害があったか、なかったか]
```

## Step 2: 再発防止策の提案

根本原因に応じて、以下のいずれか（または複数）を提案する:

| 原因 | 対応先 | 例 |
|------|--------|-----|
| ルールが存在するのに見落とした | ルールの文言を強調・明確化 | 「厳守」追加、例を追加 |
| ルール自体がなかった | 新しいルールを追加 | `.claude/rules/` に追記 |
| 手順をスキップした | チェックリストを追加・強化 | 既存の手順に項目追加 |
| 判断基準が曖昧だった | 判断基準を明文化 | 具体例・境界ケースを追記 |
| 繰り返しミス（過去にも同じ失敗） | ルールをより目立つ場所に移動 | rules/ の上部、CLAUDE.md に追記 |

**提案のフォーマット:**

```
### 再発防止策
1. [具体的なアクション] → [対象ファイル]
2. ...
```

## Step 3: ユーザー承認

提案をユーザーに見せて承認を得る。修正・追加の要望があれば反映する。

## Step 4: 適用

承認された対策を実際のファイルに適用する:

- `.claude/rules/*.md` — セッション全体に効くルール
- `.claude/commands/*.md` — 特定コマンドの手順改善
- `aspects/*/CLAUDE.md` — aspect 固有のルール
- `CLAUDE.md` — プロジェクト全体の指示

変更後、ユーザーに適用結果を報告する。

## ルール

- **言い訳しない。** 事実と原因を淡々と分析する
- **最小限の変更で最大の効果を狙う。** ルール1行追加で済むならそうする
- **既存ルールとの整合性を保つ。** 矛盾するルールを作らない
- **過剰なルール追加を避ける。** 1回のミスで10個ルールを足さない
- **同じミスが2回目なら、前回の対策が不十分だった理由も分析する**
